# ä¼™ä¼´åŒ¹é…ç³»ç»Ÿ+ç”¨æˆ·ä¸­å¿ƒç³»ç»Ÿä½œåå°ç®¡ç† by Pgeorge

## ğŸ¯ å¹³å°ç®€ä»‹

é‡‡ç”¨Springboot+Reactæ¡†æ¶æ­å»ºçš„ç”¨æˆ·ä¸­å¿ƒç®¡ç†ç³»ç»Ÿï¼Œä½œä¸ºåŸºç¡€å¹³å°ï¼Œå®Œæˆäº†ç”¨æˆ·çš„åŸºæœ¬ç®¡ç†åŠŸèƒ½ï¼Œå¦‚æ³¨å†Œã€ç™»å½•ã€è®¤è¯ã€ä¿®æ”¹ç­‰å¤šä¸ªåŠŸèƒ½ã€‚åç»­æœ¬äººä¼šæ¥å…¥æœ¬äººå®Œæˆçš„å„ç§ç³»ç»Ÿï¼Œå¹¶è¿›ä¸€æ­¥æ”¹è¿›æœ¬ç®¡ç†ç³»ç»Ÿã€‚

é‡‡ç”¨Springboot+Vueæ¡†æ¶æ­å»ºçš„ä¼™ä¼´åŒ¹é…ç³»ç»Ÿï¼Œç§»åŠ¨ç«¯H5ç½‘ç«™ï¼ˆAPPé£æ ¼ï¼‰ï¼ŒåŒ…æ‹¬ç”¨æˆ·ç™»å½•ï¼Œæ›´æ–°ä¸ªäººä¿¡æ¯ï¼ŒæŒ‰æ ‡ç­¾æœç´¢ç”¨æˆ·ã€å»ºæˆ¿ç»„é˜Ÿã€æ¨èç›¸ä¼¼ç”¨æˆ·çš„åŠŸèƒ½ã€‚

## ğŸ¶ åœ¨çº¿åœ°å€

* åå°ç®¡ç†ç³»ç»Ÿåœ¨çº¿åœ°å€:http://user.code-club.fun/user/login
* ä¼™ä¼´åŒ¹é…ç³»ç»Ÿåœ¨çº¿åœ°å€: http://code-club.fun:81/ (è¯·ä½¿ç”¨ç«ç‹æµè§ˆå™¨ç™»å½•ï¼Œè´¦å·éœ€è¦åœ¨åå°ç®¡ç†ç³»ç»Ÿä¸­æ³¨å†Œ)
* åç«¯æºç ã€springboot+Mysql+Mybatis-plusã€‘:https://github.com/Pgeorge13Z/User-center-backend
* å‰ç«¯æºç ã€React+Ant Design PROã€‘:https://github.com/Pgeorge13Z/user-center-frontend

## ğŸ¼æŠ€æœ¯é€‰å‹

å‰ç«¯ï¼š

* ç®¡ç†ç³»ç»Ÿ
  * React å¼€å‘æ¡†æ¶ï¼ˆç®¡ç†ç³»ç»Ÿï¼‰
  * Ant Design Proï¼ˆç®¡ç†ç³»ç»Ÿï¼‰

- ä¼™ä¼´åŒ¹é…ç³»ç»Ÿ
  * Vue3
  * Vant UIç»„ä»¶åº“
  * Axiosè¯·æ±‚åº“


åç«¯ï¼š

- mybatis-plusï¼ˆå¯¹ mybatis çš„å¢å¼ºï¼Œä¸ç”¨å†™ sql ä¹Ÿèƒ½å®ç°å¢åˆ æ”¹æŸ¥ï¼‰
- springbootï¼ˆ**å¿«é€Ÿå¯åŠ¨** / å¿«é€Ÿé›†æˆé¡¹ç›®ã€‚ä¸ç”¨è‡ªå·±ç®¡ç† spring é…ç½®ï¼Œä¸ç”¨è‡ªå·±æ•´åˆå„ç§æ¡†æ¶ï¼‰
- junit å•å…ƒæµ‹è¯•åº“
- Redisç¼“å­˜é«˜é¢‘æ•°æ®
- Redisåˆ†å¸ƒå¼ç™»å½•
- Redissionåˆ†å¸ƒå¼é”
- Spring Scheduler å®šæ—¶ä»»åŠ¡
- Swagger + Knife4j æ¥å£æ–‡æ¡£
- ç›¸ä¼¼åº¦åŒ¹é…ç®—æ³•

## ğŸ¨ å†…ç½®åŠŸèƒ½

| åŠŸèƒ½         | æè¿°                                                         |
| ------------ | ------------------------------------------------------------ |
| ç™»å½•/æ³¨å†Œ    | å¯†ç åŠ å¯†å­˜å‚¨ï¼Œåˆ†å¸ƒå¼sessionç™»å½•ï¼Œrediså­˜å‚¨session            |
| åå°ç”¨æˆ·ç®¡ç† | åŒ…æ‹¬å¢æ·»ã€åˆ é™¤ã€ä¿®æ”¹ç”¨æˆ·ï¼ŒåŒ…å«**æƒé™æ£€éªŒ**é€»è¾‘ï¼Œå’ŒOssåœ¨çº¿ç®¡ç†å¤´åƒç­‰å›¾ç‰‡ä¿¡æ¯ã€‚ |
| å®¹å™¨åŒ–éƒ¨ç½²   | æä¾›äº†Docker**å®¹å™¨åŒ–éƒ¨ç½²**çš„æ–¹æ¡ˆï¼Œå¹¶è§£å†³äº†**è·¨åŸŸ**ç­‰é—®é¢˜     |
| æœç´¢ç”¨æˆ·     | å…è®¸ç”¨æˆ·æ ¹æ®æ ‡ç­¾æœç´¢ç”¨æˆ·                                     |
| ç»„é˜Ÿ         | åˆ›å»ºã€åŠ å…¥ã€æ ‡ç­¾æŸ¥è¯¢ã€é‚€è¯·ã€é€€å‡ºé˜Ÿä¼ç­‰é˜Ÿä¼ç›¸å…³åŠŸèƒ½           |
| æ¨è         | é¦–é¡µæ ¹æ®ç›¸ä¼¼åº¦åŒ¹é…ç®—æ³•ï¼Œæ¨èç”¨æˆ·ã€‚                           |
| ç¼“å­˜         | ä½¿ç”¨åˆ†é¡µçš„æ–¹æ³•å±•ç¤ºç”¨æˆ·ï¼Œä½¿ç”¨Schedulerçš„å®šæ—¶ä»»åŠ¡å°†é‡è¦ç”¨æˆ·ï¼ˆæˆ–è€…é¢‘ç¹ç”¨æˆ·ï¼‰çš„æŸ¥è¯¢ç»“æœåšç¼“å­˜ã€‚ |

## ğŸ·æ¼”ç¤ºå›¾

| æ¨¡å—               | æ¼”ç¤º                                                         | æ¼”ç¤º                                                         |
| ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| ç™»å½• & æ³¨å†Œ        | ![image-20231103175854550](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202311031758623.png) | ![image-20231103175907969](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202311031759004.png) |
| é¦–é¡µ               | ![image-20231103175956592](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202311031759240.png) |                                                              |
| ç”¨æˆ·ç®¡ç†ï¼ˆç®¡ç†å‘˜ï¼‰ | ![image-20231103180024015](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202311031800129.png) | ![image-20231103180047378](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202311031800463.png) |
| ä¸ªäººä¿¡æ¯ç®¡ç†       | ![image-20231103180133200](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202311031801369.png) |                                                              |
| æ¨è               | ![image-20231210170608964](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202312101706026.png) | ![image-20231210170631453](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202312101706484.png) |
| é˜Ÿä¼               | ![image-20231210170651357](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202312101706397.png) | ![image-20231210170700351](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202312101707385.png) |
| ä¿¡æ¯ç®¡ç†           | ![image-20231210170727760](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202312101707806.png) | ![image-20231210170741772](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202312101707814.png) |



## æ‚è®°

åœ¨åšè¿™ä¸ªé¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œå­¦ä¼šçš„ä¸€äº›å°tipsã€‚

### 1. IDEAæ’ä»¶ï¼š

1. GenerateAllSetter : alt+insert å¯ä»¥è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰setæ–¹æ³•ã€‚
2. GenerateSerialVersionUID åœ¨implements Serializableæ¥å£æ—¶alt+insert å¯ä»¥è‡ªåŠ¨ç”Ÿæˆåºåˆ—åŒ–IDã€‚
3. Auto Filling Java Call Arguments åœ¨è°ƒç”¨å¯¹è±¡æ–¹æ³•æ—¶ï¼Œalt+insert å¯ä»¥è‡ªåŠ¨å¡«å……æ–¹æ³•å‚æ•°ã€‚



### 2.è°ƒè¯•æ–¹æ³•ï¼š

* F7ï¼š Step into è¿›å…¥æ–¹æ³•
* F8ï¼š Step Over ä»¥è¡Œä¸ºå•ä½ï¼Œä¸è¿›å…¥æ–¹æ³•
* F9ï¼š è·³åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼Œæ²¡æœ‰çš„è¯å°±ç»“æŸ



å› æ­¤ æ¯”å¦‚å¯ä»¥åœ¨controllerçš„æ¯ä¸€è¡Œæ‰“ä¸Šæ–­ç‚¹ï¼Œç„¶åç»™è°ƒç”¨çš„é‡è¦ä¸šåŠ¡ï¼Œå¦‚Serviceé‡Œçš„æ–¹æ³•æ‰“ä¸Šæ–­ç‚¹ï¼Œé€šè¿‡F9 è¿›å…¥Serviceä¸­ã€‚

ï¼ˆéœ€è¦å…ˆæ‰“å¼€Applicationä¸»æ–‡ä»¶çš„debugï¼Œæ‰“å¼€æœåŠ¡å™¨ï¼‰



### 3.é€»è¾‘åˆ é™¤ï¼š

mybatis-plusçš„åŠŸèƒ½ï¼ˆå­¦ä¼šæŸ¥å®˜æ–¹æ–‡æ¡£ï¼Œæ‰¾é…ç½®é€»è¾‘åˆ é™¤ï¼‰ï¼Œ

1. åœ¨domainçš„userä¸­ç»™éœ€è¦é€»è¾‘åˆ é™¤çš„å˜é‡åŠ ä¸Š@TableLogic

2. åœ¨`application.yml`ä¸­é…ç½®å¦‚ä¸‹å†…å®¹ï¼š

```yam
mybatis-plus:
  configuration:
    map-underscore-to-camel-case: false

  global-config:
    db-config:
      logic-delete-field: isDelete # å…¨å±€é€»è¾‘åˆ é™¤çš„å®ä½“å­—æ®µå(since 3.3.0,é…ç½®åå¯ä»¥å¿½ç•¥ä¸é…ç½®æ­¥éª¤2)
      logic-delete-value: 1 # é€»è¾‘å·²åˆ é™¤å€¼(é»˜è®¤ä¸º 1)
      logic-not-delete-value: 0 # é€»è¾‘æœªåˆ é™¤å€¼(é»˜è®¤ä¸º 0)
```



ç¬¬ä¸€ä¸ªé…ç½®æ˜¯å–æ¶ˆmybatis-plusçš„è‡ªåŠ¨åŠ ç²—åŠŸèƒ½ï¼›

ç¬¬äºŒä¸ªé…ç½®æ˜¯è®¾ç½®é€»è¾‘åˆ é™¤ï¼Œå³æ•°æ®åº“ä¸­è®¾ç½®isDeleteä¸º1æ—¶ï¼Œä¾¿æŸ¥è¯¢ä¸åˆ°æ­¤å€¼ã€‚



### 4. å¿«æ·é”®ï¼š

 shift+F6 é‡æ„ï¼ˆæ‰¹é‡æ›´æ”¹ä¸€ä¸ªå˜é‡ï¼‰

ctrl shift  -  å…¨éƒ¨æŠ˜å 



### 5. è·¨åŸŸé—®é¢˜è§£å†³

æµè§ˆå™¨ä¸ºäº†ç”¨æˆ·çš„å®‰å…¨ï¼Œä»…å…è®¸å‘ **åŒåŸŸåã€åŒç«¯å£** çš„æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚

å¦‚ä½•è§£å†³è·¨åŸŸï¼Ÿ

æœ€ç›´æ¥çš„æ–¹å¼ï¼šæŠŠåŸŸåã€ç«¯å£æ”¹æˆç›¸åŒçš„

**æ·»åŠ è·¨åŸŸå¤´**

è®©æœåŠ¡å™¨å‘Šè¯‰æµè§ˆå™¨ï¼šå…è®¸è·¨åŸŸï¼ˆè¿”å› cross-origin-allow å“åº”å¤´ï¼‰

**1. ç½‘å…³æ”¯æŒï¼ˆNginxï¼‰**

```nginx
# è·¨åŸŸé…ç½®
location ^~ /api/ {
    proxy_pass http://127.0.0.1:8081/api/;
    add_header 'Access-Control-Allow-Origin' $http_origin;
    add_header 'Access-Control-Allow-Credentials' 'true';
    add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';
    add_header Access-Control-Allow-Headers '*';
    if ($request_method = 'OPTIONS') {
        add_header 'Access-Control-Allow-Credentials' 'true';
        add_header 'Access-Control-Allow-Origin' $http_origin;
        add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';
        add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range';
        add_header 'Access-Control-Max-Age' 1728000;
        add_header 'Content-Type' 'text/plain; charset=utf-8';
        add_header 'Content-Length' 0;
        return 204;
    }
}
```

**2. ä¿®æ”¹åç«¯æœåŠ¡**

1. é…ç½® @CrossOrigin æ³¨è§£

2. æ·»åŠ  web å…¨å±€è¯·æ±‚æ‹¦æˆªå™¨

   ```java
   @Configuration
   public class WebMvcConfg implements WebMvcConfigurer {
    
       @Override
       public void addCorsMappings(CorsRegistry registry) {
           //è®¾ç½®å…è®¸è·¨åŸŸçš„è·¯å¾„
           registry.addMapping("/**")
                   //è®¾ç½®å…è®¸è·¨åŸŸè¯·æ±‚çš„åŸŸå
                   //å½“**Credentialsä¸ºtrueæ—¶ï¼Œ**Originä¸èƒ½ä¸ºæ˜Ÿå·ï¼Œéœ€ä¸ºå…·ä½“çš„ipåœ°å€ã€å¦‚æœæ¥å£ä¸å¸¦cookie,ipæ— éœ€è®¾æˆå…·ä½“ipã€‘
                   .allowedOrigins("http://localhost:9527", "http://127.0.0.1:9527", "http://127.0.0.1:8082", "http://127.0.0.1:8083")
                   //æ˜¯å¦å…è®¸è¯ä¹¦ ä¸å†é»˜è®¤å¼€å¯
                   .allowCredentials(true)
                   //è®¾ç½®å…è®¸çš„æ–¹æ³•
                   .allowedMethods("*")
                   //è·¨åŸŸå…è®¸æ—¶é—´
                   .maxAge(3600);
       }
   }
   ```

3. å®šä¹‰æ–°çš„ corsFilter Beanï¼Œå‚è€ƒï¼šhttps://www.jianshu.com/p/b02099a435bd



### 6.Dockerå¸¸ç”¨å‘½ä»¤

æ ¹æ® Dockerfile æ„å»ºé•œåƒï¼š

```bash
# åç«¯
docker build -t user-center-backend:v0.0.1 .

# å‰ç«¯
docker build -t user-center-frontend:v0.0.1 .
```

Docker æ„å»ºä¼˜åŒ–ï¼šå‡å°‘å°ºå¯¸ã€å‡å°‘æ„å»ºæ—¶é—´ï¼ˆæ¯”å¦‚å¤šé˜¶æ®µæ„å»ºï¼Œå¯ä»¥ä¸¢å¼ƒä¹‹å‰é˜¶æ®µä¸éœ€è¦çš„å†…å®¹ï¼‰

docker run å¯åŠ¨ï¼š

```bash
# å‰ç«¯
docker run -p 80:80 --ulimit nofile=65535:65535 -d user-center-frontend:v0.0.1

# åç«¯
docker run -p 8081:8081 --ulimit nofile=65535:65535 -d user-center-backend:v0.0.1
```

è™šæ‹ŸåŒ–

1. ç«¯å£æ˜ å°„ï¼šæŠŠæœ¬æœºçš„èµ„æºï¼ˆå®é™…è®¿é—®åœ°å€ï¼‰å’Œå®¹å™¨å†…éƒ¨çš„èµ„æºï¼ˆåº”ç”¨å¯åŠ¨ç«¯å£ï¼‰è¿›è¡Œå…³è”
2. ç›®å½•æ˜ å°„ï¼šæŠŠæœ¬æœºçš„ç«¯å£å’Œå®¹å™¨åº”ç”¨çš„ç«¯å£è¿›è¡Œå…³è”



è¿›å…¥å®¹å™¨ï¼š

```bash
docker exec -i -t  fee2bbb7c9ee /bin/bash
```



æŸ¥çœ‹è¿›ç¨‹ï¼š

```bash
docker ps 
```



æŸ¥çœ‹æ—¥å¿—ï¼š

```bash
docker logs -f [container-id]
```



æ€æ­»å®¹å™¨ï¼š

```bash
docker kill
```



åˆ é™¤å®¹å™¨ï¼š

```bash
docker rm
```





å¼ºåˆ¶åˆ é™¤é•œåƒï¼š

```bash
docker rmi -f
```



### 7. æœåŠ¡å™¨ï¼ˆarchï¼‰ä¸Šå®‰è£…å¹¶ä½¿ç”¨redisï¼Œspringbooté¡¹ç›®

**å®‰è£…redis**

```shell
sudo pacman -S redis
```

**å¯åŠ¨redisæœåŠ¡**

```shell
sudo systemctl start redis
```

**å¼€æœºå¯åŠ¨redisæœåŠ¡å™¨**

```shell
sudo systemctl enable redis
```

**æŸ¥çœ‹æœåŠ¡çŠ¶æ€**

```shell
systemctl status redis
```

**å…è®¸å…¶ä»–ipè®¿é—®**

é»˜è®¤åªå…è®¸127.0.0.1è®¿é—®ï¼Œè‹¥éœ€è¦å…¶ä»–IPè®¿é—®

```shell
sudo vim /etc/redis/redis.conf
```

æ³¨é‡Šæ‰`bind 127.0.0.1 -::1`å³å¯ï¼Œæˆ–åœ¨åé¢å¢åŠ ip

```shell
bind 127.0.0.1 **.**.**.**
```

**é‡å¯redisæœåŠ¡**

```shell
sudo systemctl restart redis
```

**Springbooté…ç½®**

* ä½¿ç”¨dockeréƒ¨ç½²æ³¨æ„äº‹é¡¹ï¼Œä¸èƒ½ä½¿ç”¨localhostï¼Œå¦åˆ™ä½¿ç”¨çš„æ˜¯å®¹å™¨å†…çš„redisï¼Œè‹¥è¦ä½¿ç”¨æœåŠ¡å™¨çš„ï¼Œè¯·é…ç½®ä¸ºæœåŠ¡å™¨ip

```yml
spring:
      #redisé…ç½®
  redis:
    port: 6379
    host: **.**.**.**
    database: 0
```



### 8.axiosæ— æ³•æºå¸¦cookieåˆ°åç«¯ï¼Œsessionå¯å­˜cookieä½†ä¸å¯å–

ç™»å½•é€»è¾‘é‡‡ç”¨sessionå­˜å‚¨ï¼Œå¹¶é‡‡ç”¨åˆ†å¸ƒå¼redisç¼“å­˜ã€‚

**ç™»å½•ä»£ç **

```java
request.getSession().setAttribute(USER_LOGIN_STATE, safetyUser);
```

**éªŒè¯ä»£ç **

```java
if (loginUser == null) {
            throw new BusinessException(ErrorCode.NO_LOGIN, "æœªç™»å½•");
        }
```

**sessioné…ç½®**

```yml
 spring:
  session:
    timeout: 86400
    store-type: redis
```



**ä¸Šçº¿æ—¶å‡ºç°çš„é—®é¢˜**

![image-20231210153722055](https://pgeorge-1310330018.cos.ap-chongqing.myqcloud.com/202312101537152.png)

å°±æ˜¯å‡ºç°äº†è·¨åŸŸè¯·æ±‚ï¼Œæµè§ˆå™¨é»˜è®¤åœ¨é¡µé¢è·³è½¬æ—¶æ— æ³•æºå¸¦cookie



**è§£å†³æ–¹æ¡ˆ**

```yml
server:
  port: 8081
  servlet:
    context-path: /api
    session:
      cookie:
        domain: code-club.fun
        same-site: lax
        secure: false
```

* ä½¿ç”¨ä¸€çº§åŸŸåï¼Œå› ä¸ºäºŒçº§åŸŸåä¹Ÿå¯ä»¥è¢«è§£æä¸ºä¸€çº§åŸŸå
* æ­¤æ–¹æ¡ˆå¿…é¡»åœ¨firefoxä¸‹ä½¿ç”¨ï¼Œchromeç›®å‰ç‰ˆæœ¬ä»ç„¶è¢«ç¦æ­¢



**æ–¹æ¡ˆäºŒ**

```yml
server:
  port: 8081
  servlet:
    context-path: /api
    session:
      cookie:
        domain: code-club.fun
        same-site: none
        secure: true
```



* same-siteè®¾ç½®ä¸ºnoneï¼Œsecureå¿…é¡»ä¸ºtrueã€‚æ­¤æ—¶éœ€è¦SSLè¯ä¹¦ï¼Œä½¿ç”¨httpsåè®®ï¼Œæ–¹å¯æˆåŠŸ



**åŸç†æ¢ç©¶ï¼š**

chromeå¼€å§‹æ”¯æŒæ–°å±æ€§SameSiteï¼Œè§£å†³æ¥å£Cookieè¢«æ»¥ç”¨ä»¥åŠCSRFçš„é—®é¢˜ã€‚

**SameSiteå±æ€§ç®€ä»‹**

ameSiteæ˜¯Cookieçš„ä¸€ä¸ªå±æ€§ï¼Œå…¶å’Œpathï¼Œdomainä¸€æ ·ï¼Œæ˜¯ä¸€ä¸ªæ™®é€šçš„Cookieå±æ€§ã€‚å…¶ä½œç”¨æ˜¯é™åˆ¶è¯¥Cookieçš„åœ¨è¯·æ±‚çš„æ—¶å€™æ˜¯å¦è¢«ä¼ é€’åˆ°Cookieæ‰€å±æœåŠ¡çš„åœºæ™¯ã€‚

å®ƒä¸€å…±æœ‰ä¸‰ä¸ªå€¼ï¼Œå…¶åŸºæœ¬å«ä¹‰åˆ†åˆ«å¦‚ä¸‹ï¼š

**Strict**

Strictæœ€ä¸ºä¸¥æ ¼ï¼Œå®Œå…¨ç¦æ­¢ç¬¬ä¸‰æ–¹ Cookieã€‚å³åœ¨è·¨ç«™ç‚¹æ—¶ï¼Œä»»ä½•æƒ…å†µä¸‹éƒ½ä¸ä¼šå‘é€ Cookieã€‚æ¢è¨€ä¹‹ï¼Œåªæœ‰å½“å‰ç½‘é¡µçš„ URL ä¸è¯·æ±‚ç›®æ ‡ä¸€è‡´ï¼Œæ‰ä¼šå¸¦ä¸Š Cookieã€‚

è®¾ç½®æ–¹å¼ä¸ºï¼šSet-Cookie: CookieName=CookieValue; SameSite=Strict;

**Lax**

Laxè§„åˆ™ç¨ç¨æ”¾å®½ï¼Œå¤§å¤šæ•°æƒ…å†µä¹Ÿæ˜¯ä¸å‘é€ç¬¬ä¸‰æ–¹ Cookieï¼Œä½†æ˜¯å¯¼èˆªåˆ°ç›®æ ‡ç½‘å€çš„ Get è¯·æ±‚é™¤å¤–( top-level navigations)ã€‚

**æ‰€æœ‰æµè§ˆå™¨çš„Cookieé»˜è®¤SameSiteå±æ€§éƒ½ä¸ºLax**ï¼Œå³SameSiteè®¾ç½®ä¸ºç©ºï¼ˆæœªè®¾ç½®ï¼‰ï¼Œåˆ™è¡¨ç¤ºä¸ºLaxã€‚

è®¾ç½®æ–¹å¼ä¸ºï¼šSet-Cookie: CookieName=CookieValue; SameSite=Lax;

è®¾ç½®äº†Strictæˆ–Laxä»¥åï¼ŒåŸºæœ¬å°±æœç»äº† CSRF æ”»å‡»ã€‚å½“ç„¶ï¼Œå‰ææ˜¯ç”¨æˆ·æµè§ˆå™¨æ”¯æŒ SameSite å±æ€§ã€‚

**None**

å¦‚æœè®¾ç½®ä¸ºNoneï¼ˆ**å‰ææ˜¯å¿…é¡»åŒæ—¶è®¾ç½®Secureå±æ€§**ï¼ˆCookie åªèƒ½é€šè¿‡ HTTPS åè®®å‘é€ï¼‰ï¼Œå¦åˆ™æ— æ•ˆï¼‰ã€‚æ­¤æ—¶å°±è¡¨ç¤ºCookieä¸å—çº¦æŸåœ¨ä»»ä½•è·¨åŸŸåœºæ™¯ä¸‹ï¼Œåªè¦è®¾ç½®äº†withCredentials=trueéƒ½ä¼šå‘é€åˆ°ä¸‰æ–¹æœåŠ¡ç«¯ã€‚

è®¾ç½®æ–¹å¼ä¸ºï¼šSet-Cookie: CookieName=CookieValue; SameSite=None; Secure;



å‚è€ƒæ–‡ç« ï¼š

https://juejin.cn/post/6999262693715050533